<databaseChangeLog
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
  <changeSet id="4-alter-customer-modify-citizenship_issued_place-to-citizenship_issued_district" author="elvin">
    <preConditions onFail="MARK_RAN">
      <columnExists tableName="customer" columnName="citizenship_issued_place"/>
    </preConditions>
    
    <renameColumn tableName="customer" oldColumnName="citizenship_issued_place" newColumnName="citizenship_issued_district_id"/>
    <modifyDataType tableName="customer" columnName="citizenship_issued_district_id" newDataType="BIGINT"/>
    <addForeignKeyConstraint baseTableName="customer" baseColumnNames="citizenship_issued_district_id"
      constraintName="fk_customer_citizenship_issued_district_id_district_id"
      referencedTableName="district" referencedColumnNames="id"/>
  </changeSet>

  <changeSet id="4-alter-customer-remove-customer_unique_citizenship_number" author="elvin">
    <dropUniqueConstraint
      tableName="customer"
      constraintName="customer_unique_citizenship_number"
      uniqueColumns="citizenship_number"/>
  </changeSet>

</databaseChangeLog>
